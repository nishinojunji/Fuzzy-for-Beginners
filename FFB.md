# 初心者のためのファジィ入門

3時間でファジィ推論まで

## ファジィ理論

対象を精密に精度良く表現しようとすると、記述するための変数とその関係が複雑になる。
ある程度以上精密さを求めるとモデルの規模が大きくなり、人による理解が困難となる。
これを不適合性の原理 Principle of imcompatiblity という。

人が自然に行っているモデルをあいまいにとらえるやり方を、
数学的に定義し、計算機で扱えるようにしたのが Zadeh のファジィ理論(1965)である。
(https://www.sciencedirect.com/science/article/pii/S001999586590241X)

## あいまいさの意義

ファジィが扱おうとしているのは、言葉に含まれるようなあいまいさである。
たとえば「遠い土地」ということばはある場所の集合を示しているが、
はっきりとここが遠い、ここは遠くないと言い切る境目があるわけではない。
人が扱うほとんどの言葉、言葉により表象される概念と具体物の関係はほとんどがこのようなあいまいさを持つ。
(https://www.sciencedirect.com/science/article/abs/pii/0020025575900365,
https://www.sciencedirect.com/science/article/abs/pii/0020025575900468,
https://www.sciencedirect.com/science/article/abs/pii/0020025575900171)

このあいまいさを有効利用することで、
人は巨大で複雑な日常世界を大掴みしてシンプルに理解し生活することができている。

## ファジィシステム

ファジィ理論にはさまざまな内容と技術があり、複雑なシステムをあいまいに表現する方法を提供する。
こうしたファジィ概念を利用して表現されたシステムをファジィシステムという。

たとえば
> 暑いならエアコンを強くし、ちょうどよければオフにする。
  
のようにエアコン制御器の動作を言葉で書いて制御システムを記述することができる。
このとき「暑い」「ちょうどよい」などの言葉はあいまいさをもち、精密に定義することは難しいが
ファジィシステムではこれを表現することができ、実用的なエアコン制御器が構築できる。

主として、ファジィ推論による関数表現、ファジィ論理を用いた関係表現、ファジィ積分を用いた感性表現などがある。

- 本入門では、ファジィ推論によるシステムの表現方法とその応用を説明する。
このときのシステムをファジィモデルともいう。

制御応用であれば、制御器をファジィ推論で構築したファジィ制御システムと、
対象システムをファジィ推論で表現し分析や予測に用いるファジィモデリングがある。
情報処理応用ではパターンの認識、識別をファジィ推論で行うファジィクラシファイアシステム、ファジィ認識器や、
意思決定プロセスをファジィ推論で記述したファジィ意思決定システムなどがある。

基本的にはあいまいな関係を記述できるため、人が認識できるような対象であれば、なんらかの形でファジィシステムとして表現できる。

## 観測データに基づくファジィシステムの実現/ファジィモデリング

実験やアンケートなどで計測した結果をなんらかの関係として表現するときにファジィ推論で表現することができる。
データからあいまいな関係を記述するこの手法をファジィモデリングという。

統計的情報処理では、サンプル点を表現する関係をさまざまな方法で関数近似する。
線形式や多項式をモデルとして仮定して誤差最小化をすれば線形回帰、パラメトリック回帰であり、
ニューラルネットでモデル誤差最小化近似することはノンパラメトリック回帰である。

ファジィシステムでモデル誤差最小化して得られたファジィモデルもノンパラメトリック回帰の一種である。
このとき、ファジィ推論は言語化しやすいファジィ集合とその関係と読み取ることが可能という特徴がある。

## ファジィ推論

本入門ではファジィシステム、ファジィモデルとして、ファジィ推論を用いる。
ファジィ推論にもいくつかの種類があり、本入門では、簡略化法を用いることにした。
その中にもいくつかの種類があり、後件部シングルトンという最も簡素な方法を対象とする。

ファジィ推論には直接法と間接法がある。(https://www.jstage.jst.go.jp/article/jfuzzy/4/2/4_KJ00002087683/_article/-char/ja/)
間接法が論理構造としては良い構造を持っているものの、ファジィ推論規則の表現が直感的に理解しにくく、また作成しづらいという課題がある。
多くのファジィシステム応用では直接法が一般的であるため、本入門も直接法のみを扱う。以下でファジィ推論という場合は直接法である。

直接法の推論の計算も中間真理値の扱いの種類があり、ここでは簡略化法を用いることとした。
直接法のファジィ推論には大きく、マムダニ式とTSK式（あるいは菅野推論）がある。
マムダニ式は推論規則の結論部(後件部)にファジィ集合を用いるものである。
TSK（高木-菅野-姜）式は後件部に線形式を用いるものであり、関係表現がし易くなおかつ柔軟な表現ができる。

後件部シングルトンのファジィ推論はTSK式の後件部の線形式を定数値（0次係数）だけにしたものである。

## ファジィ推論規則/ファジィルールとその計算

ファジィ推論はあらかじめ用意したファジィ推論規則の演算を行うことで実現する。
計算できる推論がファジィ推論の特徴である。

ファジィルール

> $R_1$ : if x is $A_1$ then y is $B_1$
> $R_i$ : if x is $A_i$ then y is $B_i$

## ファジィ命題


## ファジィ集合

ファジィ集合 F とは、人が自然に感じているあいまいな概念をモデル化したもの。
全体集合Xの上の通常の集合Aでは、$x \in X$ が属するか属しないかをはっきり決めている。
ファジィ集合 F では、要素 $x$ はあいまいに含まれる。

### 特性関数とメンバーシップ関数

全体集合 X 上の部分集合 A は各要素 x が含まれるか含まれないかを次の式で決めることができる。
この関数によってAが特徴づけられるため、特性関数と呼ぶ。

```math
\chi_A(x) = \{ 1 \  if x \in A,  0 \ if x \notin A \} 
```

ファジィ集合ではxが含まれるかどうかのあいまいさを$ \{0,1\} $でなく実数値によって帰属の度合いを表す。
この関数をメンバーシップ関数と呼ぶ。

```math
\mu_A : X -> [0, 1]
```

## よくある質問や勘違いやウソ

### ファジィ集合とファジィ推論の混同
### 確率とあいまいさ
